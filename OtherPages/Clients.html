<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Global Natural Stones</title>
			
		<link rel="stylesheet" href="../Stylesheets/Reset.css" type="text/css">
		<link rel="stylesheet" href="../Stylesheets/MainStyles.css" type="text/css"/>

		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
		<script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
		
		<script name="TestData">
			//get all the clients
			var AllClients = [
				{
					"ClID" : 0,
					"Fname" : "Joe",
					"Lname" : "Johnson",
					"Stage" : 1,
					
					"Basic" : {
						"Phone" : "14789999999",
						"Email" : "JimmyJohJohnson@email",
						"Address1" : {
							"Street" : "123 Rainbow Road",
							"City" : "Dayton",
							"State" : "Ohio",
							"Zip" : "12345"
						},
						"Projects" : [
							"Cabinets", "Appliances", "Floor"
						]
					},
						
					"Templates" : {
					},
					
					"Invoice" : {
					},
					
					"Installation" : {
					}
				},
				
				{
					"ClID" : 1,
					"Fname" : "Jeremy",
					"Lname" : "Oosterban",
					"Stage" : 1,
					
					"Basic" : {
						"Phone" : "14789999999",
						"Email" : "MichiganFan@email",
						"Address1" : {
							"Street" : "123 Ooster Bouevarde",
							"City" : "Dayton",
							"State" : "Ohio",
							"Zip" : "12345"
						},
						"Projects" : [
							"Cabinets", "Floor"
						]
					},
						
					"Templates" : {
					},
					
					"Invoice" : {
					},
					
					"Installation" : {
					}
				}
			];
		</script>
	
		<script name="ConstVars">
			const CDATA_FADESPEED = 120;
		</script>
	</head>
	  
	<body>
		<script src="MainHeader.js"></script>
		<script>display("Clients");</script>
		
		<div class="big-container">
			<!--side navigation-->
			<aside>				
				<nav id="ClientCategories">			
					
					<div class="SmallCategories">
						<h2>View clients by...</h2>											
						<button class="SmallCatButtons Basic neat-button">Basic</button>
						<button class="SmallCatButtons outTemplate neat-button">Waiting for Template</button>
						<button class="SmallCatButtons gotTemplate neat-button">Received Templates</button>
						<button class="SmallCatButtons prepareInvoice neat-button">Prepare Invoice</button>
						<button class="SmallCatButtons outInvoice neat-button">Send Invoice</button>
						<button class="SmallCatButtons gotConfirmation neat-button">Received confirmation of customer</button>
						<button class="SmallCatButtons scheduleInstal neat-button">Schedule Installation</button>
						<button class="SmallCatButtons gotPayment neat-button">Received Payment</button>
						<button class="SmallCatButtons Completed neat-button">Completed</button>
						<button class="SmallCatButtons AllClients neat-button">All Clients</button>
					</div>
					
					

					<form>
						<button id="AddClient">+ Add Client</button>
					</form>
				</nav>				
			</aside>
			
			<!--list of clients -->
			<main>
				<ul id="ClientList">
					<!--each li is a client-->
					<h1 id="sectionTitle">Basic</h1>
					
					<li class="Client">
						<section class="ListHead">
							<h4>Joe Johnson</h4>
							<p>Joined 22 January, 2020</p>
							<div class="CHeadTopLinks ">
								<div>
									<button class="btnShowInfo">Show All</button>
									<button class="btnEditInfo">Edit</a>
								</div>
							</div>
						</section>
						
						<section class="ClientInfo">
							<nav class="SmallCategories">
								<button id="CursorForBtn" class="SmallCatButtons Basic">Basic</button>
								<button class="SmallCatButtons gotTemplate">Templates</button>
								<button class="SmallCatButtons outInvoice">Invoice</button>
								<button class="SmallCatButtons scheduleInstal">Scheduled Installation</button>
								<button class="SmallCatButtons Comments">Comments</button>
							</nav>
							
							<div class="ClientData">
								<span class="Info"><h5>Phone:</h5><p class="CPhone">(478) 999-9999</p></span>
								<span class="Info"><h5>Email:</h5><p class="CEmail">JimmyJohJohnson@email.com</p></span>
								
								<span class="Info"><h5>Address:</h5><p class="CAddress">123 Rainbow Road</p></span>
								<span class="Info"><h5>City:</h5><p class="CCity">Dayton</p></span>
								<span class="Info"><h5>State:</h5><p class="CState">OH</p></span>
								<span class="Info"><h5>Zip:</h5><p>12345</p></span>
								
								<span class="Info"><h5>Projects:</h5><p>Cabinet, Appliances, Floor</p></span>
							</div>
							
							<button class="ClientNextPhase">Move client to next phase</button>
							
						</section>
					</li>
					
					
				</ul>
			</main>
		</div>
		<script name="MakeNewWindow-ClientMoreInfo">
		
		const { ipcRenderer } = require('electron');
		
		//when the show info button clicked
		document.querySelector(".btnShowInfo").addEventListener("click", function() {
			//send the 'display-client' command to the main js (will display new page with client info)
			//needs id
			ipcRenderer.send("display-client-Info", 1);
		});
		
		document.querySelector(".btnEditInfo").addEventListener("click", function() {
			//send the 'display-client-edit' command to the main js (will display new page with client	info)
			//needs id
			ipcRenderer.send("display-client-edit", 1);
		});
		</script>
		
		<script name="ExpandClientInfoClick">
		
		$(document).ready( function() {
			
			//displays the client information when clicking on an li
			$(".ListHead").click(function() {			
				var thisClient = $(this).parent();
				
				//closes all other clint info's				
				$('.Client').not(thisClient).find(".ClientInfo").hide(400);
				$('.Client').not(thisClient).find(".CHeadTopLinks").hide(400);
				
				//opens the clicked client info
				$(thisClient).find(".ClientInfo").animate({height: "toggle"});
				$(thisClient).find(".CHeadTopLinks").toggle(400);
			});
		
		});
		</script>
		
		<script name="DisplayClients">
			/* ANDREW NEEDS CODE IN PopulateMain FUNCTION */
			let currentStageForm = 1;
			
			
			//populate basic form
			function populateMain(currentStage){
				console.log("Loading clients from stage " + currentStage);
				var Client;
				
				//remove clients in the form already
				/* ADD FOLLOWING ONCE ANDREW'S CODE IS IMPLEMENTED */
				/*$("main").children().fadeOut(
					120, 
					function() {$(this).remove();}
				
				);*/
			
				for (Client of AllClients){
					if (Client.Stage == currentStage){
					/* SHOULD BE REPLACED WITH ANDREW'S CODE */
						console.log(Client.Fname + " is printed.");
					}
				}
			}			
			populateMain(1);
			
			
			//jquery, give all butons stage attr and handle clicking
			$(document).ready(function(){
				/*
				//cursor DOM object for buttons
				let cursor = $("<div id='CursorForBtn'>&nbsp;</div>");
				//make cursor a triangle using css
				$(cursor).css({
					/*"width": 0,
					"height": 0,
					"border-style": "solid",
					"border-width": "14px 0 14px 25px",
					"border-color": "transparent transparent transparent rgb(243,243,243)",
					"float": "left",
					"margin-right": "15px"
					
					"width": 0,
					"height": 0,
					"border-top": "20px solid transparent",
					"border-left": "30px solid #8f2831",
					"border-bottom": "20px solid transparent",
					
					"position": "absolute",
					"left": 0
				});
				$(cursor).insertBefore("#ClientCategories button.Basic");
				*/
				//fill buttons with stage info
				let btnNum = 1;
				$(".SmallCatButtons").each(function(){
					$(this).attr("Stage", btnNum++);
				});
				
				//when the button is clicked, fill the main and insert cursor
				$("aside .SmallCatButtons").click(function(){
					$("#CursorForBtn").removeAttr("id");
					$(this).attr("id", "CursorForBtn");
					//populate main with the stage value of the button
					populateMain(
						$(this).attr("stage")
					);
					
					
				});
			});
			
			

		</script>
		
		<script name="NavigateClients">
			$(document).ready(function(){
			
				$(".ClientInfo .SmallCategories button").click(function(){
					let ThisClientInfo = $(this).parent().parent();
					
					//remove the things already there
					$(ThisClientInfo).find(".ClientData").children().fadeOut(
						CDATA_FADESPEED, 
						function() {$(this).remove();}
					);
					
					//fill info 
					/*ANDREW CODE PROBABLY*/
					let strAClass = "SmallCatButtons "; //to hold html class name
					let ThisClientData = $(ThisClientInfo).find(".ClientData");
					
					if ($(this).attr("class") == strAClass + "gotTemplate"){
						//display Template
						console.log("client template is displayed");
						
						$("<p>Template stuff</p>").hide().appendTo(ThisClientData).fadeIn(CDATA_FADESPEED);
					}
					else if ($(this).attr("class") == strAClass + "outInvoice"){
						//display Invoice
						console.log("client invoice is displayed");
						
						$("<p>Invoice stuff</p>").hide().appendTo(ThisClientData).fadeIn(CDATA_FADESPEED);
					}
					else if ($(this).attr("class") == strAClass + "scheduleInstal"){
						//display install stuff
						console.log("client install is displayed");
						
						$("<p>Installation stuff</p>").hide().appendTo(ThisClientData).fadeIn(CDATA_FADESPEED);
					}
					else if ($(this).attr("class") == strAClass + "Comments"){
						//display install stuff
						console.log("client comments are displayed");
						
						$("<p>Comments</p>").hide().appendTo(ThisClientData).fadeIn(CDATA_FADESPEED);
					}
					else {
						//display basic (if none other found)
						console.log("client Basic is displayed");
						
						$("<p>Basic stuff</p>").hide().appendTo(ThisClientData).fadeIn(CDATA_FADESPEED);
					}
				});
				
			});
		</script>
	</body>
</html>
