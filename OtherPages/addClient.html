<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale-1.0">
	<title>Global Natural Stones</title>
	
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
	
	<link rel="stylesheet" href="../Stylesheets/Reset.css" type="text/css"/>
	<link rel="stylesheet" href="../Stylesheets/extraForms.css" type="text/css"/>
	<link rel="stylesheet" href="../JQUI/jquery-ui.css"/>
	
	<script type="text/javascript" src="../JQUI/external/jquery/jquery.js"></script>
	<script type="text/javascript" src="../JQUI/jquery-ui.js"></script>
	
	<script name="DEV, test client">
	
	</script>
	<script name="Get CliID">
		const { ipcRenderer } = require('electron');
		//let cli;
		
		cli = ipcRenderer.sendSync("getID");
		
		console.log(cli);
	</script>
	
	<style>		
		.ui-button{
			border: 2px solid rgb(180,180,180);
			margin: 0;
			width: 275px;
			border-bottom: 0px;
		}
		
		label{
			margin-left: 30px;
		}
		
		input[type=checkbox] {
            transform: scale(1.3);
        }    

	</style>
</head>

<body>

<form id="formMain" method="get" action="">
<fieldset>
	<h1>Basic Information</h1>

	<label for="first_name">First Name:</label><input required type="text" name="txtName" id="first_name" value="test First">
	<label for="last_name">Last Name:</label><input required type="text" name="txtLastName" id="last_name" title="Edit the client's last name" value="test Last">

	
	<section>
		<h2>Contact</h2>
		<label for="phone">Phone Number:</label><input required type="number" name="numPhoneNum" id="phone" value="420">
		<label for="email">Email:</label><input required type="text" name="txtEmail" id="email"  value="TheBoi@google.com">
	</section>
	
	<section>
		<h2>Address</h2>
		<label for="street_address">Street:</label><input required type="text" name="txtAddressStreet" id="street_address" title="enter street name and house number" value="test Addr">
		<label for="zip">Zip code:</label><input required type="text" id="zip">
		
		<label for="city">City:</label>
			<select required name="city" id="city">
				<option value="Day" selected>Dayton</option>
				<option value="Cin">Cincinnati</option>
			</select>
			
		<label for="state">State:</label>
		<select required id="state" name="txtState">
			<option value="AL">Alabama</option>
			<option value="AK">Alaska</option>
			<option value="AZ">Arizona</option>
			<option value="AR">Arkansas</option>
			<option value="CA">California</option>
			<option value="CO">Colorado</option>
			<option value="CT">Connecticut</option>
			<option value="DE">Delaware</option>
			<option value="DC">District Of Columbia</option>
			<option value="FL">Florida</option>
			<option value="GA">Georgia</option>
			<option value="HI">Hawaii</option>
			<option value="ID">Idaho</option>
			<option value="IL">Illinois</option>
			<option value="IN">Indiana</option>
			<option value="IA">Iowa</option>
			<option value="KS">Kansas</option>
			<option value="KY">Kentucky</option>
			<option value="LA">Louisiana</option>
			<option value="ME">Maine</option>
			<option value="MD">Maryland</option>
			<option value="MA">Massachusetts</option>
			<option value="MI">Michigan</option>
			<option value="MN">Minnesota</option>
			<option value="MS">Mississippi</option>
			<option value="MO">Missouri</option>
			<option value="MT">Montana</option>
			<option value="NE">Nebraska</option>
			<option value="NV">Nevada</option>
			<option value="NH">New Hampshire</option>
			<option value="NJ">New Jersey</option>
			<option value="NM">New Mexico</option>
			<option value="NY">New York</option>
			<option value="NC">North Carolina</option>
			<option value="ND">North Dakota</option>
			<option value="OH">Ohio</option>
			<option value="OK">Oklahoma</option>
			<option value="OR">Oregon</option>
			<option value="PA">Pennsylvania</option>
			<option value="RI">Rhode Island</option>
			<option value="SC">South Carolina</option>
			<option value="SD">South Dakota</option>
			<option value="TN">Tennessee</option>
			<option value="TX">Texas</option>
			<option value="UT">Utah</option>
			<option value="VT">Vermont</option>
			<option value="VA">Virginia</option>
			<option value="WA">Washington</option>
			<option value="WV">West Virginia</option>
			<option value="WI">Wisconsin</option>
			<option value="WY">Wyoming</option>
		</select>								
	</section>
	
	<section>
		<h2>Contractor/Ref Info</h2>
		<label for="contractor">Name:</label> <input required type="text" name="txtConName" id="contractor" value="Freddie Mercury">
		<label for="contractor_phone">Phone Number:</label> <input required type="number" name="numConPhoneNum" id="contractor_phone" value="420">
		<label for="contractor_email">Email:</label> <input required type="text" name="txtConEmail" id="contractor_email" value="TheBoi@google.com">
	</section>
	
	<section>
		<h2>Project Info</h2>
		<input required type="text" id="project" value="">
		
		<label for="cabinet">Cabinet:</label><input required type="text" id="cabinet" name="txtCabinet">
		<label for="appliances">Appliances:</label><input required type="text" id="appliances" name="txtAppliances">
		<label for="floor">Floor:</label><input required id="floor" type="text" name="txtFloor">
		<label for="other">Other:</label><input required type="" id="other" name="txtOtherProj">
	</section>

	<button type="button" class="Save">Save</button>
</fieldset>
</form>

	<script>
		//finds the value of an input html
function findValue(inputObj){
	if ($(inputObj).is("textarea"))
		return inputObj.val();
	
	if ($(inputObj).is("select")){
		let val = $(inputObj).val();
		
		if (val.toUpperCase() == "YES" || val.toUpperCase() == "Y")
			return true;
		else if (val.toUpperCase() == "NO" || val.toUpperCase() == "N")
			return false;
		else
			return val;	
	}
	
	if ($(inputObj).hasClass("Datepick")){
		let d = new Date($(inputObj).val());
		
		if (isValidD(d))return d.toISOString();
		else return "no val";
	}
	
	switch ($(inputObj).attr("type")){
		
		//if the input is a text box
		case "text":
			return $(inputObj).val();			
			break;
		
		case "number":
			return $(inputObj).val();
			
		case "checkbox":
			return ($(inputObj).is(":checked"));
			break;
			
		case "radio":
			return ($(inputObj).is(":checked"));
			break;
			
		default:
			return "no val";
			break;
	}
	
	return null;
}

	//creates the message for updating client
	function createUpdateMessage(parentE = $("body")){
		let changeMessage = {
			"first_name" : "",
			"last_name" : "",
			"stage" : "",	
			"date_added": "",
			
			//basic
			"phone" : "",
			"email" : "",
			"street_address" : "",
			"city" : "",
			"state" : "",
			"zip" : "",

			"contractor": "",
			"contractor_phone": "",
			"contractor_email": "",
			
			
			"project" : "",
			"cabinet": "",
			"appliances": "",
			"floor": "",
			"other": "",		
		};
		
		let ok = true;
		
		$("input").each(function(){
			//find the value of each input box
			let content = p(findValue(this))
			if (content == "<i>not set</i>" || content == "no val"){
				ok = false;
				return;
			}
			
			//if value is different than whats in the database, change it
			if(content != cli[$(this).attr("id")]){
				//add one change
				changeMessage.changes.push(
					{
						"key": $(this).attr("id"),
						"data": content
					}
				);
			}
		});
		
		if (!ok)
			return {};
			
		return changeMessage;
	}
	</script>
</body>